(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{345:(e,t,a)=>{"use strict";a.d(t,{Er:()=>h,ef:()=>n,j7:()=>d});var r,s,i=a(1990);let l=12,c="relevance",o={perPage:l=null!=(r=JSON.parse(localStorage.getItem("perPage")))?r:12,filterBy:null!=(s=localStorage.getItem("filterBy"))?s:"relevance"},n=(0,i.Z0)({name:"filters",initialState:o,reducers:{setPerPage(e,t){e.perPage=t.payload},setFilterBy(e,t){e.filterBy=t.payload}}}),{setPerPage:d,setFilterBy:h}=n.actions;n.reducer},1531:(e,t,a)=>{"use strict";a.d(t,{C:()=>r});let r=()=>{localStorage.setItem("category",""),localStorage.setItem("sortKey",""),localStorage.setItem("sortBy","recommendations"),localStorage.setItem("activePage","1"),localStorage.setItem("perPage","12")}},2765:(e,t,a)=>{Promise.resolve().then(a.bind(a,3101))},3101:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var r=a(5155),s=a(3758),i=a(3139),l=a(345);function c(e){let{handleChangePage:t}=e,{activePage:a}=(0,i.GV)(e=>e.pages);return(0,r.jsxs)("div",{className:"pagination_main",children:[(0,r.jsx)(n,{className:"left_arrow",onClick:()=>t(a-1)}),(0,r.jsx)("div",{className:"pagination_pages",children:(0,r.jsx)(o,{handleChangePage:t})}),(0,r.jsx)(n,{className:"right_arrow",onClick:()=>t(a+1)})]})}let o=e=>{let{handleChangePage:t}=e,{pagesArr:a}=(0,i.GV)(e=>e.pages);return(0,r.jsx)(r.Fragment,{children:a.map(e=>(0,r.jsx)("div",{onClick:()=>t(e.id),className:"".concat(e.active&&"active"),children:e.id},e.id))})},n=e=>{let{className:t,onClick:a}=e;return(0,r.jsx)("div",{className:"arrow_bg",children:(0,r.jsx)("svg",{className:t,onClick:a,fill:"#000000",height:"14px",width:"14px",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 330 330",xmlSpace:"preserve",children:(0,r.jsx)("path",{id:"XMLID_92_",d:"M111.213,165.004L250.607,25.607c5.858-5.858,5.858-15.355,0-21.213c-5.858-5.858-15.355-5.858-21.213,0.001 l-150,150.004C76.58,157.211,75,161.026,75,165.004c0,3.979,1.581,7.794,4.394,10.607l150,149.996 C232.322,328.536,236.161,330,240,330s7.678-1.464,10.607-4.394c5.858-5.858,5.858-15.355,0-21.213L111.213,165.004z"})})})};function d(){let e="recommendations";e=localStorage.getItem("sortBy");let{entities:t,status:a}=(0,i.GV)(e=>e.books),{perPage:l}=(0,i.GV)(e=>e.filters),o=(0,i.jL)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"filters_main",children:[(0,r.jsxs)("div",{className:"filters_left",children:["category"===e&&(0,r.jsx)(h,{arr:u,type:"filterBy"}),(0,r.jsx)(h,{arr:g,type:"perPage"})]}),(0,r.jsx)("div",{className:"filters-right",children:"loaded"===a&&(0,r.jsx)(c,{handleChangePage:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=Math.ceil((t.numFound||t.work_count||t.size)/l);e<1?e=1:e>a&&(e=a),localStorage.setItem("activePage",JSON.stringify(e)),o((0,s.yd)({activePage:e,numberOfPages:a}))}})})]}),(0,r.jsx)("div",{className:"hr"})]})}let h=e=>{let{arr:t,type:a}=e,{filterBy:s,perPage:c}=(0,i.GV)(e=>e.filters),o=(0,i.jL)(),n=e=>{o((0,l.j7)(Number(e.target.value))),localStorage.setItem("perPage",JSON.stringify(e.target.value))},d=e=>{o((0,l.Er)(e.target.value)),localStorage.setItem("filterBy",e.target.value)};return(0,r.jsxs)("div",{className:"per_page_main",children:[(0,r.jsx)("p",{children:"perPage"===a?"PER PAGE: ":"FILTER BY: "}),(0,r.jsx)("select",{value:"perPage"===a?c:s,onChange:e=>"perPage"===a?n(e):d(e),children:t.map(e=>(0,r.jsx)("option",{value:e.value,children:"perPage"===a?e.value:e.child},e.id))})]})},u=[{id:0,value:"relevance",child:"Relevance"},{id:1,value:"new",child:"Newest to oldest"},{id:2,value:"old",child:"Oldest no newest"},{id:3,value:"rating",child:"Best rating"}],g=[{id:0,value:"3"},{id:1,value:"6"},{id:2,value:"9"},{id:3,value:"12"}];var m=a(2115),v=a(4396);let j=[{id:0,child:"Love"},{id:1,child:"Crime"},{id:2,child:"Action"},{id:3,child:"Drama"},{id:4,child:"Music"},{id:5,child:"Business"},{id:6,child:"Philosophy"}],f=[{id:0,authorKey:"/authors/OL23919A",child:"J. K. Rowling"},{id:1,authorKey:"/authors/OL26783A",child:"Лев Толстой"},{id:2,authorKey:"/authors/OL24529A",child:"Emily Brontë"},{id:3,authorKey:"/authors/OL27695A",child:"Agatha Christie"},{id:4,authorKey:"/authors/OL22242A",child:"Фёдор Достоевский"},{id:5,authorKey:"/authors/OL27349A",child:"F. Scott Fitzgerald"},{id:6,authorKey:"/authors/OL9388A",child:"William Shakespeare"},{id:7,authorKey:"/authors/OL21594A",child:"Jane Austen"}];var p=a(9019);let x=()=>{let{status:e}=(0,i.GV)(e=>e.books),{isOpenSort:t}=(0,i.GV)(e=>e.adaptive),a=(0,i.jL)(),[s,l]=(0,m.useState)(null),[c,o]=(0,m.useState)(null),n=(0,m.useRef)(null);return(0,m.useEffect)(()=>{o(window.innerWidth)},[]),(0,m.useEffect)(()=>{n.current&&l(Math.floor(n.current.offsetHeight))},[e]),(0,m.useEffect)(()=>{let e=()=>{o(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h4",{onClick:()=>a((0,v.BL)(!t)),className:"sort_toggle",children:t?"CLOSE":"OPEN"}),(0,r.jsx)("div",{className:"hr"}),(0,r.jsxs)("section",{className:"sort_main",ref:n,style:{height:t||c&&c>600?"".concat(s,"px"):"0px"},children:[(0,r.jsx)(y,{sort:"category",arr:j}),(0,r.jsx)(y,{sort:"author",arr:f})]})]})},y=e=>{let{sort:t,arr:a}=e,{perPage:l,filterBy:c}=(0,i.GV)(e=>e.filters),o=(0,i.jL)(),n=(e,a)=>{let r=a||e.toLowerCase();switch(localStorage.setItem("category",e),localStorage.setItem("sortBy",t),localStorage.setItem("activePage",JSON.stringify(1)),localStorage.setItem("sortKey",r),t){case"author":o((0,p.b5)({sortKey:r,perPage:l,activePage:1}));break;case"category":o((0,p.jE)({sortKey:r,perPage:l,activePage:1,filterBy:c}))}o((0,s.yd)({activePage:1}))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"category",children:[(0,r.jsx)("h3",{children:t.toUpperCase()}),a.map(e=>(0,r.jsx)("p",{onClick:()=>n(e.child,e.authorKey&&e.authorKey),children:e.child},e.id))]}),(0,r.jsx)("div",{className:"hr"})]})};var k=a(6766);let N=()=>{let e="",t="recommendations";e=localStorage.getItem("sortKey")||"",t=localStorage.getItem("sortBy")||"recommendations";let{activePage:a}=(0,i.GV)(e=>e.pages),{perPage:r,filterBy:s}=(0,i.GV)(e=>e.filters),l=(0,i.jL)(),c=(0,m.useCallback)(()=>{switch(t){case"category":l((0,p.jE)({sortKey:e,perPage:r,activePage:a,filterBy:s}));break;case"author":l((0,p.b5)({sortKey:e,perPage:r,activePage:a}));break;case"recommendations":l((0,p.RU)({perPage:r,activePage:a}));break;default:throw Error("Сортировка не найдена")}},[a,r,s,l,t,e]);(0,m.useEffect)(()=>{c()},[s,a,r,c])};function _(){let{entities:e,status:t}=(0,i.GV)(e=>e.books);return(N(),"loading"===t)?(0,r.jsx)("h2",{className:"loading",children:"Loading..."}):"loaded"===t?(0,r.jsx)(w,{entities:e}):void 0}let w=e=>{let{entities:t}=e,a=localStorage.getItem("category")||"",s=t.reading_log_entries||t.works||t.entries;if(void 0!=s)return(0,r.jsxs)("div",{className:"books_main",children:[a&&(0,r.jsx)("h3",{className:"category_name",children:a}),(0,r.jsx)("div",{className:"books_inner",children:Object.keys(s).map(e=>(0,r.jsx)("a",{href:"/books".concat(s[e].key),children:(0,r.jsxs)("div",{className:"book_item",children:[(0,r.jsx)(k.default,{className:"cover",src:s[e].cover_id&&"https://covers.openlibrary.org/b/id/".concat(s[e].cover_id,"-M.jpg")||s[e].covers&&"https://covers.openlibrary.org/b/id/".concat(s[e].covers[0],"-M.jpg")||"/images/no-cover.jpg",width:150,height:225,style:{height:225},priority:!0,alt:"cover"}),(0,r.jsx)("p",{children:s[e].title})]})},e))})]})};var S=a(9050),b=a(6662),P=a(5922);function I(){let e=(0,m.useRef)(null),t=(0,i.jL)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.default,{}),(0,r.jsx)("main",{onClick:()=>t((0,S.RK)(!1)),ref:e,className:"outer_main",children:(0,r.jsxs)("div",{className:"inner_main",children:[(0,r.jsx)(x,{}),(0,r.jsxs)("div",{className:"books_and_filters",children:[(0,r.jsx)(d,{}),(0,r.jsx)(_,{})]})]})}),(0,r.jsx)(P.default,{})]})}},3139:(e,t,a)=>{"use strict";a.d(t,{GV:()=>i,jL:()=>s});var r=a(4540);let s=r.wA,i=r.d4},3758:(e,t,a)=>{"use strict";a.d(t,{JN:()=>l,yd:()=>c});var r=a(1990);let s=1,i={pagesArr:[{id:1,active:!0},{id:2,active:!1},{id:3,active:!1},{id:4,active:!1},{id:5,active:!1}],activePage:s=Number(localStorage.getItem("activePage"))||1},l=(0,r.Z0)({name:"pages",initialState:i,reducers:{changePage(e,t){let{numberOfPages:a,activePage:r}=t.payload;return{...e,pagesArr:a&&r>a-2?e.pagesArr.map(e=>e.id===r?{...e,active:!0}:{...e,active:!1}):[{id:r<=2?1:r-2,active:1===r},{id:r<=2?2:r-1,active:2===r},{id:r<=2?3:r,active:!(r<=2)},{id:r<=2?4:r+1,active:!1},{id:r<=2?5:r+2,active:!1}],activePage:r}}}}),{changePage:c}=l.actions;l.reducer},4396:(e,t,a)=>{"use strict";a.d(t,{BL:()=>s,PO:()=>r});let r=(0,a(1990).Z0)({name:"adaptive",initialState:{isOpenSort:!0},reducers:{setIsOpenSort(e,t){e.isOpenSort=t.payload}}}),{setIsOpenSort:s}=r.actions;r.reducer},5922:(e,t,a)=>{"use strict";a.d(t,{default:()=>o});var r=a(5155),s=a(6874),i=a.n(s),l=a(6766),c=a(1531);function o(){return(0,r.jsxs)("footer",{children:[(0,r.jsx)("div",{onClick:c.C,className:"hr"}),(0,r.jsx)(i(),{href:"/",children:(0,r.jsxs)("div",{className:"inner_footer",children:[(0,r.jsx)(l.default,{src:"/favicon.png",alt:"book",width:24,height:24}),(0,r.jsx)("h4",{children:"BOOKS FINDER"})]})})]})}},6662:(e,t,a)=>{"use strict";a.d(t,{default:()=>v});var r=a(5155),s=a(3139),i=a(9050),l=a(2115),c=a(9019);function o(){let[e,t]=(0,l.useState)(""),a=(0,s.jL)(),{isSearching:i}=(0,s.GV)(e=>e.search),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{o.current&&o.current.focus()},[i]),(0,l.useEffect)(()=>{let t=setTimeout(()=>{e.length>=3&&a((0,c.$Q)(e))},500);return()=>clearTimeout(t)},[e,a]),(0,r.jsxs)("div",{className:"search_main",children:[(0,r.jsx)("input",{placeholder:"Search",className:"search_input",type:"text",value:e,ref:o,onChange:e=>{t(e.target.value)}}),e.length>=3&&(0,r.jsx)(n,{})]})}let n=()=>{let{searchedItems:e}=(0,s.GV)(e=>e.search),t=new Map,a=new Map;e.forEach(e=>{let r,s,i,l;e.author_name&&(r=e.author_name[0]),e.author_key&&(s=e.author_key[0]),e.title&&(i=e.title),e.key&&(l=e.key),r&&s&&t.set(r,s),l&&i&&a.set(i,l)});let i=[];t.size&&(i=Array.from(t.entries()).map(e=>{let[t,a]=e;return{title:t,key:a}}));let l=[];return a.size&&(l=Array.from(a.entries()).map(e=>{let[t,a]=e;return{title:t,key:a}})),(0,r.jsx)("div",{className:"search_outer",children:(0,r.jsxs)("div",{className:"search_inner",children:[(0,r.jsx)(d,{arr:i,type:"authors"}),(0,r.jsx)(d,{arr:l,type:"books"})]})})},d=e=>{let{arr:t,type:a}=e,l=(0,s.jL)(),o=(e,t)=>{let a="/authors/".concat(e);localStorage.setItem("category",t),localStorage.setItem("sortKey",a),localStorage.setItem("sortBy","author"),localStorage.setItem("activePage","1"),localStorage.setItem("perPage","12"),l((0,i.RK)(!1)),l((0,c.b5)({sortKey:a,perPage:12,activePage:1}))};return(0,r.jsxs)("div",{className:"searched_".concat("books"===a?"books":"authors"),children:[(0,r.jsx)("h3",{children:"books"===a?"BOOKS":"AUTHORS"}),(0,r.jsx)("div",{className:"searched_content",children:t.length?(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>"books"===a?(0,r.jsx)("a",{href:"/books".concat(e.key),children:e.title},t):(0,r.jsx)("a",{href:"/",onClick:()=>o(e.key,e.title),children:e.title},t))}):(0,r.jsx)("p",{className:"not-found",children:"No results found"})})]})};var h=a(1531),u=a(6874),g=a.n(u),m=a(6766);function v(){let{isSearching:e}=(0,s.GV)(e=>e.search);return(0,r.jsx)("nav",{className:"header_main",children:(0,r.jsxs)("div",{className:"inner_header",children:[(0,r.jsx)(j,{handleClear:h.C}),(0,r.jsx)(f,{}),e&&(0,r.jsx)(o,{})]})})}let j=e=>{let{handleClear:t}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"left_header",children:(0,r.jsx)(g(),{href:"/",children:(0,r.jsxs)("div",{onClick:t,className:"fullsize_main",children:[(0,r.jsx)(m.default,{src:"/favicon.png",alt:"book",width:24,height:24}),(0,r.jsx)("h4",{children:"BOOKS FINDER"})]})})})})},f=()=>{let{isSearching:e}=(0,s.GV)(e=>e.search),t=(0,s.jL)(),a=a=>{a.stopPropagation(),t((0,i.RK)(!e))};return(0,r.jsxs)("div",{onClick:e=>a(e),className:"search",children:[(0,r.jsx)("h4",{children:"SEARCH"}),(0,r.jsx)(m.default,{height:16,width:16,src:"/icons/search.svg",alt:"Search Icon"})]})}},9019:(e,t,a)=>{"use strict";a.d(t,{$Q:()=>c,RU:()=>l,b5:()=>i,jE:()=>s});var r=a(1990);let s=(0,r.zD)("books/fetchCategories",async e=>{let{sortKey:t,perPage:a,activePage:r,filterBy:s}=e;try{let e=await fetch("https://openlibrary.org/subjects/".concat(t,".json?limit=").concat(a,"&offset=").concat(r*a-a).concat("relevance"===s?"":"&sort=".concat(s)));return await e.json()}catch(e){console.error("Error fetching categories:",e)}}),i=(0,r.zD)("books/fetchAuthors",async e=>{let{sortKey:t,perPage:a,activePage:r}=e;try{let e=await fetch("https://openlibrary.org".concat(t,"/works.json?limit=").concat(a,"&offset=").concat(r*a-a));return await e.json()}catch(e){console.error("Error fetching categories:",e)}}),l=(0,r.zD)("books/fetchRecommendations",async e=>{let{perPage:t,activePage:a}=e;try{let e=await fetch("https://openlibrary.org/people/mekBot/books/want-to-read.json?limit=".concat(t,"&page=").concat(a)),r=await e.json(),s=r.reading_log_entries.map(e=>e.work);return{...r,reading_log_entries:[...s]}}catch(e){console.error("Error fetching recommendations:",e)}}),c=(0,r.zD)("search/fetchSearch",async e=>{try{let t=await fetch("https://openlibrary.org/search.json?q=".concat(e,"&fields=*,availability&limit=5"));return(await t.json()).docs}catch(e){console.error("Error fetching search results:",e)}})},9050:(e,t,a)=>{"use strict";a.d(t,{RK:()=>l,XX:()=>i});var r=a(1990),s=a(9019);let i=(0,r.Z0)({name:"search",initialState:{searchedItems:[],isSearching:!1},reducers:{setIsSearching(e,t){e.isSearching=t.payload}},extraReducers:e=>{e.addCase(s.$Q.fulfilled,(e,t)=>{e.searchedItems=[...t.payload]})}}),{setIsSearching:l}=i.actions;i.reducer}},e=>{var t=t=>e(e.s=t);e.O(0,[635,766,874,441,684,358],()=>t(2765)),_N_E=e.O()}]);